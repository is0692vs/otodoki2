# プロジェクト全体の AGENT ルール

このリポジトリで作業する AI エージェントは、以下のガイドラインと検証フローに従ってください。

## 共通の検証フロー

1. **環境起動**: ルートで `make up` を実行するか、`docker compose up -d --build` でバックエンドとフロントエンドを同時に立ち上げる。
2. **ログ確認**: `docker compose logs --tail=200` や `docker compose logs -f api` を使って、キュー補充や API 呼び出しの状態を確認する。
3. **API 疎通テスト**: コンテナ起動後に `curl http://localhost:8000/api/v1/tracks/suggestions?limit=5` などのエンドポイントを叩き、レスポンス内容とメタ情報を確認する。
4. **終了処理**: 検証完了後は `docker compose down` でコンテナとネットワークをクリーンに停止する。

コマンド例:

```bash
make up
# or
docker compose up -d --build
docker compose logs --tail=200
curl -sS http://localhost:8000/api/v1/tracks/suggestions?limit=5
docker compose down
```

このファイルは、AI エージェントがプロジェクトの構造と役割を理解し、効率的に作業を進めるためのガイドラインを提供します。

## AGENTS.md ファイルについて

各ディレクトリ直下の `AGENTS.md` ファイルは、そのディレクトリおよびそのサブディレクトリのコードベースの構造、目的、主要なコンポーネント、および開発における AI エージェントへの指示を記述します。

### 記述ルール

- **自己言及**: `AGENTS.md` ファイルは、それが存在するディレクトリを起点とした説明を行います。つまり、「このディレクトリには...」「このモジュールは...」といった形で記述します。
- **構造と役割**: 各ディレクトリや主要なファイルが持つ役割と、それらがどのように連携しているかを説明します。
- **主要なコンポーネント**: そのディレクトリ内で特に重要なクラス、関数、モジュールなどを特定し、その機能と目的を簡潔に記述します。
- **AI エージェントへの指示**: そのディレクトリのコードを扱う際に、AI エージェントが特に注意すべき点や、推奨される開発プラクティス（例: 特定のパターンに従う、テストを徹底する）があれば記述します。

## プロジェクト更新時の AGENT への指示

プロジェクトの変更があった場合、AI エージェントは以下のドキュメントを適切に更新する責任を負います。

1.  **`README.md` の更新**:
    - プロジェクトの全体的な概要、セットアップ手順、主要な機能、環境変数などに変更があった場合、ルートの `README.md` を更新します。
    - 特に、ユーザーが直接操作する部分（セットアップ、実行方法、設定など）に変更があった場合は、分かりやすく記述します。
2.  **`AGENTS.md` ファイルの更新**:
    - 新しいディレクトリが追加された場合、そのディレクトリに適切な `AGENTS.md` を新規作成します。
    - 既存のディレクトリ内のコード構造や役割が変更された場合、該当する `AGENTS.md` を更新します。
    - 各 `AGENTS.md` が、そのディレクトリ以下の最新の構造と役割を正確に反映していることを確認します。
3.  **`docs/` ディレクトリの更新**:
    - プロジェクトのより詳細な設計、特定の機能の実装詳細、デバッグガイド、API ドキュメントなど、長期的な情報として保持すべき内容は `docs/` ディレクトリ内の適切なファイルに追記または新規作成します。
    - `docs/README.md` も適宜更新し、新しいドキュメントへのリンクや変更点を記載します。

これらのドキュメントは、プロジェクトの理解を深め、将来の開発者が円滑に作業を進めるための重要な資産です。常に最新かつ正確な情報を提供することを心がけてください。

## ドキュメントの更新について (AI エージェント向け)

このプロジェクトでは、AI エージェントがプロジェクトの構造と役割を理解し、効率的に作業を進めるためのガイドラインとして `AGENTS.md` ファイルを導入しています。プロジェクトに変更があった場合、AI エージェントは以下のドキュメントを適切に更新する責任を負います。

## 作業完了時の報告ルール

- 最終レスポンスには、**実施した変更内容のサマリー** と **実行したテストと結果** を必ず含める。
- テストを実行できなかった場合は、その理由と想定される影響を明記する。
- 追加で実施した Docker 検証（ログ確認や `curl` テストなど）があれば、コマンドと結果の要約を添える。
